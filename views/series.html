<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PlatBid - Bidding Series</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="app-wrapper mt-5">
        <div class="sidebar">
            <a class="navbar-brand d-flex align-items-center mb-4" href="/home">
                <img src="https://companieslogo.com/img/orig/DT-1480c5d6.svg" alt="Logo" width="50" height="50" class="d-inline-block align-text-top me-2">
                <span class="fs-4">DynaBid</span>
            </a>
            <ul class="nav nav-pills flex-column mb-auto">
                <li class="nav-item">
                    <a href="/home" class="nav-link">
                        Home
                    </a>
                </li>
                <li>
                    <a href="/series" class="nav-link active" aria-current="page">
                        Start Bidding
                    </a>
                </li>
            </ul>
            <div class="mt-auto">
                <a href="/" class="btn btn-outline-light w-100" onclick="logOut()">Log Out</a>
            </div>
        </div>

        <div class="main-content">
            <h2 class="text-center mb-4">Choose Bidding Series</h2>
            <div id="series-list" class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
                <p class="text-muted text-center">Loading series...</p>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function logOut() {
            alert('You have been logged out.');
        }

        fetch('/bids/series/active')
          .then(response => response.json())
          .then(data => {
            const seriesListDiv = document.getElementById('series-list');
            if (seriesListDiv && data.length > 0) {
              seriesListDiv.innerHTML = data.map(s => `
                <div class="col">
                    <a href="/bid/${s.seriesName}" class="card text-center p-4 text-decoration-none text-body h-100 d-flex flex-column justify-content-between">
                        <div>
                        <h4 class="card-title fw-bold">${s.seriesName}</h4>
                        <p class="card-text text-muted mb-0">Bidding ends on:</p>
                        </div>
                        <div class="mt-3">
                        <h5 class="fw-bold text-danger">${new Date(s.endDate).toLocaleDateString()}</h5>
                        </div>
                    </a>
                </div>
              `).join('');
            }else {
              seriesListDiv.innerHTML = '<p class="text-muted text-center">No active bidding series at the moment.</p>';
            }
          })
          .catch(error => {
            console.error('Error fetching series:', error);
            const seriesListDiv = document.getElementById('series-list');
            seriesListDiv.innerHTML = `<div class="col-12"><div class="alert alert-danger" role="alert">Error loading bidding series.</div></div>`;
          });

    </script>
</body>
</html>